# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/claude-code) when working with code in this repository.

## Project Overview

PromptOps Studio - ä¼ä¸šçº§ AI åº”ç”¨å¹³å° MVPï¼Œç”¨äºæ¼”ç¤ºå…¨æ ˆæŠ€æœ¯èƒ½åŠ›ã€‚ç”¨æˆ·å¯ä»¥åˆ›å»º Workflowã€ä¸Šä¼ çŸ¥è¯†åº“æ–‡æ¡£ã€ä¸Šä¼ æµ‹è¯•é›† Datasetï¼Œè§¦å‘æ‰¹é‡ Run æ‰§è¡Œï¼Œå¹¶æŸ¥çœ‹ç»“æœã€trace å’Œå®¡è®¡æ—¥å¿—ã€‚

## ç”¨æˆ·èº«ä»½ä¸å­¦ä¹ ç›®æ ‡

**æˆ‘æ˜¯è°ï¼š** CS å­¦ç”Ÿï¼Œç¼–ç¨‹æ–°æ‰‹ï¼Œæ­£åœ¨é€šè¿‡è¿™ä¸ªé¡¹ç›®å­¦ä¹ å…¨æ ˆå¼€å‘ã€‚

**æˆ‘çš„ç›®æ ‡ï¼š** å®Œæˆ `Docs/plan-CN.md` ä¸­æè¿°çš„é¡¹ç›®ï¼Œä½œä¸ºç»ƒæ‰‹é¡¹ç›®æ¥æå‡æŠ€æœ¯èƒ½åŠ›ã€‚

**å¯¹ Claude çš„è¦æ±‚ï¼š**

1. **æ–°æ‰‹å‹å¥½** - åƒå¯¹å¾…ç¼–ç¨‹åˆå­¦è€…ä¸€æ ·è®²è§£ï¼Œä¸è¦å‡è®¾æˆ‘å·²ç»æ‡‚äº†
2. **æœ¯è¯­è§£é‡Š** - é‡åˆ°ä¸“ä¸šæœ¯è¯­ã€æŠ€æœ¯åè¯æ—¶ï¼Œå¿…é¡»æ‹†å¼€ç”¨é€šä¿—è¯­è¨€è§£é‡Š
3. **å¾ªåºæ¸è¿›** - å¤æ‚æ¦‚å¿µè¦åˆ†æ­¥éª¤è®²è§£ï¼Œä¸è¦ä¸€æ¬¡æ€§æŠ›å‡ºå¤ªå¤šä¿¡æ¯
4. **å¤šä¸¾ä¾‹å­** - ç”¨å…·ä½“ä¾‹å­å¸®åŠ©ç†è§£æŠ½è±¡æ¦‚å¿µ

**æœ¯è¯­è§£é‡Šç¤ºä¾‹ï¼š**
```
âŒ é”™è¯¯ç¤ºèŒƒ: "æˆ‘ä»¬ç”¨ Kafka åšæ¶ˆæ¯é˜Ÿåˆ—å®ç°å¼‚æ­¥è§£è€¦"

âœ… æ­£ç¡®ç¤ºèŒƒ: "æˆ‘ä»¬ç”¨ Kafka åšæ¶ˆæ¯é˜Ÿåˆ—å®ç°å¼‚æ­¥è§£è€¦ã€‚

   è®©æˆ‘è§£é‡Šä¸€ä¸‹è¿™äº›æœ¯è¯­ï¼š
   - **Kafka** - ä¸€ä¸ªæ¶ˆæ¯ä¼ é€’ç³»ç»Ÿï¼Œå°±åƒé‚®å±€ä¸€æ ·ï¼Œè´Ÿè´£åœ¨ä¸åŒç¨‹åºä¹‹é—´ä¼ é€’æ¶ˆæ¯
   - **æ¶ˆæ¯é˜Ÿåˆ—** - å°±åƒæ’é˜Ÿä¹°å¥¶èŒ¶ï¼Œæ¶ˆæ¯æŒ‰é¡ºåºæ’é˜Ÿç­‰å¾…è¢«å¤„ç†
   - **å¼‚æ­¥** - å‘é€æ–¹å‘å®Œæ¶ˆæ¯å°±èµ°ï¼Œä¸ç”¨ç­‰æ¥æ”¶æ–¹å¤„ç†å®Œï¼ˆåƒå‘å¾®ä¿¡ï¼Œä¸ç”¨ç­‰å¯¹æ–¹å›å¤ï¼‰
   - **è§£è€¦** - è®©ä¸¤ä¸ªç¨‹åºä¸ç›´æ¥ä¾èµ–å¯¹æ–¹ï¼Œé€šè¿‡"ä¸­é—´äºº"ï¼ˆKafkaï¼‰é€šä¿¡ï¼Œè¿™æ ·ä¸€ä¸ªæŒ‚äº†ä¸å½±å“å¦ä¸€ä¸ª"
```

## Documentation

- **`Docs/plan-CN.md`** - é¡¹ç›®è®¡åˆ’å’Œå½“å‰è¿›åº¦ï¼ˆé‡è¦ï¼‰
- `Docs/` æ–‡ä»¶å¤¹å­˜æ”¾é‡è¦æ–‡æ¡£

## Tech Stack

**å‰ç«¯:**
- React + TypeScript + Ice + Less

**å¹³å°åç«¯ (platform-api/):**
- Java 17 + Spring Boot 3.x
- Gradle æ„å»º
- Nacos (æœåŠ¡æ³¨å†Œä¸é…ç½®)

**AI æœåŠ¡ (ai-runtime/):**
- Python + FastAPI + Uvicorn
- LangChain / LangGraph
- Azure OpenAI
- Poetry ä¾èµ–ç®¡ç†

**æ•°æ®ä¸ä¸­é—´ä»¶:**
- MySQL - å¹³å°å…ƒæ•°æ®å­˜å‚¨
- Redis - ç¼“å­˜ä¸å¹‚ç­‰æ§åˆ¶
- Milvus - å‘é‡æ•°æ®åº“ (çŸ¥è¯†åº“æ£€ç´¢)
- Kafka - å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—

**DevOps:**
- Docker / docker-compose
- GitHub Actions CI/CD

## Project Structure

```
promptops-studio/
â”œâ”€â”€ frontend/          # React å‰ç«¯ (å¾…åˆ›å»º)
â”œâ”€â”€ platform-api/      # Spring Boot åç«¯
â”œâ”€â”€ ai-runtime/        # FastAPI + LangGraph AI æœåŠ¡ (å¾…åˆ›å»º)
â”œâ”€â”€ deploy/            # éƒ¨ç½²é…ç½®å’Œåˆå§‹åŒ–è„šæœ¬ (å¾…åˆ›å»º)
â”œâ”€â”€ Docs/              # é¡¹ç›®æ–‡æ¡£
â”‚   â””â”€â”€ plan-CN.md     # é¡¹ç›®è®¡åˆ’
â”œâ”€â”€ docker-compose.yml
â””â”€â”€ .github/workflows/ # CI/CD
```

## Build & Run Commands

```bash
# å¯åŠ¨åŸºç¡€è®¾æ–½ (MySQL, Redis, Kafka, Milvus)
docker-compose up -d

# Platform API (Spring Boot)
cd platform-api
./gradlew bootRun

# AI Runtime (FastAPI) - å¾…å®ç°
cd ai-runtime
poetry install
poetry run uvicorn main:app --reload

# Frontend - å¾…å®ç°
cd frontend
npm install
npm run dev
```

## Key Concepts

- **Project** - é¡¹ç›®ç©ºé—´ï¼Œéš”ç¦»èµ„æºä¸æ•°æ®
- **KnowledgeBase (KB)** - æ–‡æ¡£é›†åˆ + Milvus å‘é‡ç´¢å¼•
- **Workflow** - LangGraph å·¥ä½œæµå®šä¹‰
- **Dataset** - æµ‹è¯•é›† (JSONL æ ¼å¼)
- **Run** - ä¸€æ¬¡æ‰¹é‡æ‰§è¡Œ (å¼‚æ­¥ Kafka)
- **Trace** - èŠ‚ç‚¹çº§æ‰§è¡Œè½¨è¿¹

## Development Guidelines

- éµå¾ª monorepo ç»“æ„
- Platform API ä½¿ç”¨ RESTful è®¾è®¡
- AI Runtime é€šè¿‡ Kafka æ¶ˆè´¹ `run.requested` æ¶ˆæ¯
- æ‰€æœ‰å®¡è®¡æ“ä½œè®°å½•åˆ° `audit_logs` è¡¨

## CLI æ“ä½œè§„èŒƒ

æ‰§è¡Œä»»ä½• CLI å‘½ä»¤æ—¶ï¼Œå¿…é¡»éµå¾ªä»¥ä¸‹è§„èŒƒï¼š

### 1. å‘½ä»¤è§£è¯»
æ¯æ¬¡æ‰§è¡Œ CLI å‘½ä»¤å‰ï¼Œå¿…é¡»é€ä¸€è§£é‡Šæ¯ä¸ªå‘½ä»¤çš„ä½œç”¨ã€‚

**ç¤ºä¾‹ï¼š**
```
æ‰§è¡Œ: cd .. && pwd && git status
è§£è¯»:
- `cd ..` - åˆ‡æ¢åˆ°ä¸Šä¸€çº§ç›®å½•
- `pwd` - æ‰“å°å½“å‰å·¥ä½œç›®å½•è·¯å¾„
- `git status` - æŸ¥çœ‹ git ä»“åº“å½“å‰çŠ¶æ€
```

### 2. æ“ä½œç±»å‹æ ‡æ³¨

**åªè¯»æ“ä½œ** - æ˜ç¡®æ ‡æ³¨ä¸ºã€Œåªè¯»æ“ä½œï¼Œå®‰å…¨ã€ï¼š
- `ls`, `cat`, `pwd`, `find`, `grep` ç­‰æŸ¥çœ‹ç±»å‘½ä»¤
- `git status`, `git log`, `git diff` ç­‰æŸ¥è¯¢ç±» git å‘½ä»¤

**å†™å…¥/ä¿®æ”¹æ“ä½œ** - å¿…é¡»è¯´æ˜é£é™©ï¼š
- æ–‡ä»¶æ“ä½œ: `rm`, `mv`, `cp`, `mkdir`, `touch`, é‡å®šå‘ `>` ç­‰
- Git æ“ä½œ: `git add`, `git commit`, `git push`, `git reset`, `git checkout` ç­‰
- åŒ…ç®¡ç†: `npm install`, `pip install`, `gradle build` ç­‰

### 3. é£é™©ç­‰çº§

| ç­‰çº§ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| ğŸŸ¢ å®‰å…¨ | åªè¯»æ“ä½œï¼Œä¸ä¿®æ”¹ä»»ä½•å†…å®¹ | `ls`, `cat`, `git status` |
| ğŸŸ¡ ä½é£é™© | å¯é€†çš„ä¿®æ”¹æ“ä½œ | `git add`, `mkdir`, `touch` |
| ğŸŸ  ä¸­é£é™© | éœ€è¦è°¨æ…çš„ä¿®æ”¹æ“ä½œ | `git commit`, `npm install` |
| ğŸ”´ é«˜é£é™© | å¯èƒ½é€ æˆæ•°æ®ä¸¢å¤±æˆ–ä¸å¯é€† | `rm -rf`, `git reset --hard`, `git push --force` |

### 4. è¾“å‡ºæ ¼å¼ç¤ºä¾‹

```
ğŸ“‹ å³å°†æ‰§è¡Œ: git add . && git commit -m "feat: add feature"
ğŸ“– å‘½ä»¤è§£è¯»:
  - `git add .` - å°†å½“å‰ç›®å½•æ‰€æœ‰æ›´æ”¹æ·»åŠ åˆ°æš‚å­˜åŒº
  - `git commit -m "..."` - åˆ›å»ºä¸€ä¸ªæ–°çš„æäº¤
âš ï¸ é£é™©ç­‰çº§: ğŸŸ  ä¸­é£é™©
ğŸ’¡ å½±å“: ä¼šåœ¨æœ¬åœ°ä»“åº“åˆ›å»ºæ–°æäº¤ï¼Œå¯é€šè¿‡ git reset æ’¤é”€
```
